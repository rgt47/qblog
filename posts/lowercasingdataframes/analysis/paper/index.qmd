---
title: 'Set Names to Lowercase for Multiple Dataframes in R'
draft: true
image: "img/Rlogo.png"
document-type: "blog"
date: today
categories: [Data Analysis & Visualization]
tags:
  - r
  - data-cleaning
  - data-preprocessing
---

::: column-margin
![R](img/Rlogo.png)
:::

## Introduction

Frequent task in R is to set names of dataframes to lowercase.

Assume a data space with many objects. Several of which are data frames
We want to idenify all the dataframes by surveying their classes and conver the
column names to lowercase no matter what case format they currently have.

## Prerequisites

To follow along with this tutorial, you'll need:

- Basic knowledge of R programming
- R installed on your system
- The purrr package for functional programming

## Step-by-Step Implementation

### Setting up the Environment

First, let's load required packages and clean our environment:

```r
library(purrr)
rm(list = ls())
```

### Creating Test Data

Construct a few objects. Two of them dataframes:

```r
aa = data.frame(COL_1 = letters[6:4], COL_2 = 1:3)
bb = data.frame(COL_1 = letters[6:8], COL_2 = 1:3)
bb = as_tibble(bb)
cc = 1:10
dd = letters[1:4]
```

### Finding and Converting Dataframes

Start by creating a list of all the dataframes in the workspace:

```r
# test each object in environment to see if it is a dataframe.
# keep a list of the data frames in df1
df0 = eapply(.GlobalEnv, \(x) if (is.data.frame(x)) return(x) )
df1 <- l1[!sapply(l1,is.null)]
# process dataframes in df1 and lower the case of the names
df2 = lapply(df1, \(x) {names(x) = tolower(names(x))
  return(x) })
 # move the processed dataframes in df3 out to global env
list2env(df2, .GlobalEnv)
```

### Alternative Approach

An alternative method from [How to get the list of available data frames in R environment?](https://www.tutorialspoint.com/how-to-get-the-list-of-available-data-frames-in-r-environment):

```r
df1 = names(which(unlist(eapply(.GlobalEnv,is.data.frame))))
```

## Key Takeaways

- Using `eapply()` allows us to check all objects in the environment efficiently
- We can filter for dataframes and process them in batch operations
- The `list2env()` function is useful for updating global environment objects
- This approach works even for objects with multiple classes (like tibbles)

## Additional Implementation Notes

```{r echo=FALSE, eval=FALSE}
# list of objects in environment
# v1 = objects()
# l1 = lapply(v1, function(x) class(get(x)))
# l1b = sapply(v1, function(x) is.data.frame(get(x)))
# l1b = eapply(.GlobalEnv, function(x) is.data.frame(x))

# l1 = eapply(.GlobalEnv, \(x) is.data.frame(x))

# df1 = names(l1)[unlist(l1)]
# names(df1) = c("bb", "aa")
# l1 = lapply(l1, function(x) {ifelse(any(x == "data.frame"), "data.frame", x)})
# array of names of dataframe objects in environment
# df1 = v1[l1 == "data.frame"]
# NB this wont work if object has more than one class...as with "bb"

# create a list of dataframes
df2 = lapply(df1, get)
names(df2) = df1
l1 = eapply(.GlobalEnv, \(x) {test = is.data.frame(x)
if (test) return(x)
})
df1 <- l1[!sapply(l1,is.null)]
# process dataframes in df2 and lower the case of the names
df2 = lapply(df1, function(x) {
names(x) = tolower(names(x))
 x
 })
 # move the processed dataframes in df3 out to global env
list2env(df2, .GlobalEnv)
# df2 = lapply(df1, \(x) {set_names(tolower(names(x)))
#  return(x) })
```

## Further Reading

- [Advanced R: Environments](https://adv-r.hadley.nz/environments.html)
- [purrr documentation](https://purrr.tidyverse.org/)
- In development

## Step-by-Step Implementation

In development

## Key Takeaways

In development

## Further Reading

In development
