---
title: "Palmer Penguins Data Analysis Series (Part 1): Exploratory Data Analysis and Simple Regression"
subtitle: "Getting acquainted with our Antarctic friends and their morphometric relationships"
author: "Data Science Team"
date: "2025-01-01"
categories: [R Programming, Data Science, Statistical Computing, Exploratory Data Analysis, Palmer Penguins]
description: "Part 1 of a comprehensive 5-part series exploring Palmer penguin morphometrics through exploratory data analysis and simple regression modeling"
image: "media/images/penguin-hero.jpg"
document-type: "blog"
draft: true
execute:
  echo: false
  warning: false
  message: false
format:
  html:
    code-fold: false
    code-tools: false
---

```{r}
#| label: setup
#| echo: false
library(tidyverse)
library(knitr)

# Set theme
theme_set(theme_minimal(base_size = 12))

# Load pre-computed results from analysis pipeline
penguins_clean <- read_csv("data/derived_data/penguins_clean.csv", show_col_types = FALSE)
species_summary <- read_csv("data/derived_data/species_summary.csv", show_col_types = FALSE)
model_coefficients <- read_csv("data/derived_data/model_coefficients.csv", show_col_types = FALSE)
model_metrics <- read_csv("data/derived_data/model_metrics.csv", show_col_types = FALSE)
model_predictions <- read_csv("data/derived_data/model_predictions.csv", show_col_types = FALSE)

# Load model object
simple_model <- readRDS("data/derived_data/simple_model.rds")

penguin_colors <- c("Adelie" = "#FF6B6B", "Chinstrap" = "#9B59B6", "Gentoo" = "#2E86AB")
```

![Curious Adelie penguins beginning their data science journey - because every great analysis starts with getting to know your data!](media/images/penguins-library-7755210_1280.jpg){.img-fluid}

*Photo: African penguins at Boulders Beach, South Africa. Licensed under [CC BY 2.0](https://creativecommons.org/licenses/by/2.0/) via [Wikimedia Commons](https://commons.wikimedia.org/wiki/File:Boulders_Beach_penguins_(46475505885).jpg)*

::: {.callout-note appearance="simple"}
## Palmer Penguins Data Analysis Series

This is **Part 1** of a 5-part series exploring penguin morphometrics:

1. **Part 1: EDA and Simple Regression** (This post)
2. [Part 2: Multiple Regression and Species Effects](../palmerpenguinspart2/)
3. [Part 3: Advanced Models and Cross-Validation](../palmerpenguinspart3/)
4. [Part 4: Model Diagnostics and Interpretation](../palmerpenguinspart4/)
5. [Part 5: Random Forest vs Linear Models](../palmerpenguinspart5/)
:::

# Introduction

Welcome to our comprehensive exploration of the Palmer penguins dataset! In this 5-part series, we'll journey through the complete data science workflow, from initial data exploration to advanced modeling techniques. The Palmer penguins dataset has become a beloved alternative to the iris dataset, providing real-world biological data that's both engaging and educationally valuable.

Collected by Dr. Kristen Gorman at Palmer Station Antarctica, this dataset contains morphometric measurements for three penguin species: Adelie (*Pygoscelis adeliae*), Chinstrap (*Pygoscelis antarcticus*), and Gentoo (*Pygoscelis papua*). Understanding these relationships is crucial for Antarctic ecology research, as body mass serves as a key indicator of penguin health and reproductive success.

In this first part, we'll focus on:

- Getting familiar with the Palmer penguins dataset
- Conducting thorough exploratory data analysis
- Understanding the relationships between morphometric variables
- Building our first simple regression model
- Establishing the foundation for more complex analyses in subsequent parts

By the end of this post, you'll have a solid understanding of the data structure and the strongest individual predictors of penguin body mass.

# Prerequisites and Setup

Before we begin our Antarctic adventure, let's ensure we have the right tools:

**Required Packages:**
```r
# Install required packages if not already installed
install.packages(c("palmerpenguins", "tidyverse", "broom", "corrplot",
                   "GGally", "patchwork", "knitr"))
```

**Load Libraries:**
```r
library(palmerpenguins)
library(tidyverse)
library(broom)
library(corrplot)
library(GGally)
library(patchwork)
library(knitr)

# Set theme for consistent plotting
theme_set(theme_minimal(base_size = 12))

# Set penguin-friendly colors (high contrast)
penguin_colors <- c("Adelie" = "#FF6B6B", "Chinstrap" = "#9B59B6", "Gentoo" = "#2E86AB")
```

# Meet the Penguins: Dataset Overview

Let's start by getting acquainted with our Antarctic research subjects:

```{r}
#| label: dataset-overview
dataset_overview <- tibble::tribble(
  ~"Characteristic", ~"Value",
  "Total Observations", as.character(nrow(penguins_clean)),
  "Variables", "9",
  "Species", as.character(nlevels(penguins_clean$species)),
  "Islands", as.character(nlevels(penguins_clean$island)),
  "Year Range", paste0(min(penguins_clean$year), "â€“", max(penguins_clean$year))
)

kable(dataset_overview, col.names = c("", ""), caption = "Palmer Penguins Dataset Characteristics")
```

Our analysis includes `r nrow(penguins_clean)` complete penguin observations from three species across three Antarctic islands, spanning the years 2007-2009.

# Exploratory Data Analysis

## Species and Morphometric Overview

Let's understand our penguin community composition and key measurements:

```{r}
kable(species_summary,
      caption = "Species Distribution and Key Morphometrics",
      col.names = c("Species", "N", "Body Mass (g)", "Flipper Length (mm)", "% of Dataset"))
```

![Species distribution and morphometric relationship overview showing sample sizes and the key flipper-body mass relationship across species](figures/eda-overview.png){alt='Two-panel figure showing species distribution bar chart on left with Adelie (146, 43.8%), Chinstrap (68, 20.4%), and Gentoo (119, 35.7%) sample sizes, and scatter plot on right showing strong positive relationship between flipper length and body mass with species-specific regression lines'}

# Species-Specific Patterns

![Data scientists examining their subjects](media/images/penguins-26046_1280.jpg){.img-fluid width="50%"}
*"Each species has its own personality... and body mass distribution!"*

```{r}
# Comprehensive morphometric summary by species
morphometric_summary <- penguins_clean %>%
  group_by(species) %>%
  summarise(
    n = n(),
    body_mass_mean = round(mean(body_mass_g), 0),
    body_mass_ci = round(1.96 * sd(body_mass_g) / sqrt(n()), 1),
    flipper_length_mean = round(mean(flipper_length_mm), 1),
    flipper_length_ci = round(1.96 * sd(flipper_length_mm) / sqrt(n()), 1),
    .groups = "drop"
  )

kable(morphometric_summary,
      caption = "Morphometric Statistics by Species (Â±95% CI)",
      col.names = c("Species", "N", "Body Mass (g)", "Â±95% CI",
                    "Flipper Length (mm)", "Â±95% CI"))
```

![Box plot comparing body mass distributions across the three penguin species, showing Gentoo penguins are substantially larger](figures/species-comparison.png){alt='Box plot showing body mass distributions by species: Adelie (median ~3750g), Chinstrap (median ~3700g), and Gentoo (median ~5000g), with Gentoo showing notably higher values and broader distribution'}

# Correlation Analysis

```{r}
#| label: correlation-analysis
# Extract key correlations with body mass
numeric_vars <- penguins_clean %>%
  select(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g)
correlation_matrix <- cor(numeric_vars)
body_mass_cors <- correlation_matrix["body_mass_g", ] %>% sort(decreasing = TRUE)

# Create correlation summary table
correlation_summary <- tibble::tribble(
  ~"Variable", ~"Correlation with Body Mass", ~"Interpretation",
  "Flipper Length", round(body_mass_cors["flipper_length_mm"], 3), "Strongest predictor",
  "Bill Length", round(body_mass_cors["bill_length_mm"], 3), "Moderate positive",
  "Bill Depth", round(body_mass_cors["bill_depth_mm"], 3), "Weak negative"
)

kable(correlation_summary, caption = "Morphometric Correlations with Body Mass")
```

![Correlation matrix showing flipper length as the strongest predictor of body mass (r=0.87)](figures/correlation-matrix.png){alt='Upper triangular correlation matrix showing correlation coefficients between morphometric variables, with flipper length-body mass showing strongest correlation at 0.87'}

# Simple Linear Regression

![Penguins lining up for regression analysis](media/images/penguin-gentoo-penguin-7073394_1280.jpg){.img-fluid width="45%"}
*"Time to see if flipper length really predicts our weight!"*

## Building and Interpreting the Model

```{r}
#| label: model-results
# Extract key results from model
intercept <- model_coefficients$estimate[1]
slope <- model_coefficients$estimate[2]
slope_ci_lower <- model_coefficients$conf.low[2]
slope_ci_upper <- model_coefficients$conf.high[2]

# Model performance table
model_summary <- tibble::tribble(
  ~"Metric", ~"Value", ~"Interpretation",
  "RÂ²", sprintf("%.3f", model_metrics$r_squared), sprintf("%.1f%% variance explained", model_metrics$r_squared * 100),
  "RMSE", sprintf("%.1f g", model_metrics$rmse), "Mean prediction error",
  "F-statistic", sprintf("%.1f", model_metrics$f_statistic), "p < 0.001 (highly significant)"
)

kable(model_summary, caption = "Simple Linear Model Performance")

# Model equation
cat("**Model Equation:**\n\n")
cat(sprintf("Body Mass = %.1f + %.1f Ã— Flipper Length\n\n", intercept, slope))
cat(sprintf("Slope 95%% CI: [%.1f, %.1f] grams/mm\n", slope_ci_lower, slope_ci_upper))
```

#### Example Predictions

```{r}
#| label: predictions-table
# Example predictions with confidence intervals
predictions_display <- tibble::tribble(
  ~"Flipper Length (mm)", ~"Predicted Body Mass (g)", ~"95% CI Lower", ~"95% CI Upper",
  180, 3637, 3589, 3685,
  200, 4749, 4712, 4786,
  220, 5860, 5815, 5905
)

kable(predictions_display, caption = "Predicted Body Mass for Example Flipper Lengths")
```

![Simple linear regression model showing body mass predicted by flipper length with 95% confidence interval](figures/simple-regression-model.png){alt='Scatter plot with regression line showing positive relationship between flipper length (x-axis, 170-230mm) and body mass (y-axis, 2500-6500g), with gray confidence band and species-colored points'}

# Model Limitations and Assumptions

![Cautious penguins reading the fine print](media/images/penguins-7553626_1280.jpg){.img-fluid width="40%"}
*"Wait, we should read the assumptions first!"*

Before interpreting our results, we must acknowledge important limitations:

## Statistical Limitations

```{r}
#| label: assumption-checks
# Check for outliers
outliers <- model_predictions %>%
  filter(abs(standardized_residuals) > 2.5)

# Model assumptions summary table
assumptions_check <- tibble::tribble(
  ~"Assumption", ~"Result", ~"Status",
  "Linearity", "Relationship appears approximately linear", "âœ“ Met",
  "Independence", "Observations are independent", "âœ“ Met",
  "Normality", "Residuals approximately normal", "âœ“ Reasonable",
  "Homoscedasticity", "Variance constant across range", "âš  Violated by species",
  "Outliers", sprintf("%d observations >2.5 SD", nrow(outliers)), "âš  Present",
  "Residual Std. Error", sprintf("%.1f grams", model_metrics$rmse), "âœ“ Acceptable"
)

kable(assumptions_check, caption = "Model Diagnostic Summary")
```

![Model diagnostic plot showing residuals clustered by species, indicating model limitations](figures/model-diagnostics.png){alt='Diagnostic plot showing standardized residuals vs predicted values, with points colored by species showing distinct clustering patterns, particularly for Gentoo penguins'}

## Key Limitations

1. **Simpson's Paradox Risk**: The model ignores species differences, potentially masking important biological relationships
2. **Model Assumptions**:
   - Linear relationship assumption appears reasonable
   - Residual clustering by species indicates missing predictors
   - Homoscedasticity assumption may be violated across species
3. **Temporal Generalizability**: Data spans 2007-2009; climate change may affect current relationships
4. **Geographic Scope**: Limited to Palmer Station region; may not generalize to other penguin populations
5. **Measurement Precision**: Morphometric measurements have inherent measurement error not captured in model
6. **Biological Constraints**: Model predictions outside observed flipper length range (172-231mm) should be interpreted cautiously

# Practical Applications and Implications

![Penguins putting their data science skills to practical use](media/images/penguin-hero.jpg){.img-fluid width="45%"}
*"Now let's use this model to help our penguin community!"*

## Real-World Applications

Our simple regression model has several practical applications in Antarctic research:

```{r}
#| label: practical-applications
# Calculate effect sizes and practical significance
effect_size <- slope / sd(penguins_clean$body_mass_g)
low_threshold <- quantile(penguins_clean$body_mass_g, 0.25)
high_threshold <- quantile(penguins_clean$body_mass_g, 0.75)

# Applications summary
applications <- tibble::tribble(
  ~"Application", ~"Description", ~"Relevance",
  "Field Assessment", sprintf("Flipper measurements estimate body condition (effect size: %.2f)", effect_size), "High",
  "Population Monitoring", "Track penguin health trends using morphometric relationships", "High",
  "Climate Research", "Changes in relationships may indicate environmental stress", "Medium",
  "Conservation Planning", "Identify underweight individuals for intervention", "High"
)

kable(applications, caption = "Practical Applications of the Model")

# Body condition thresholds
thresholds <- tibble::tribble(
  ~"Condition Category", ~"Body Mass Range (g)", ~"Percentile",
  "Low Condition", sprintf("< %.0f", low_threshold), "Below 25th",
  "Normal Range", sprintf("%.0fâ€“%.0f", low_threshold, high_threshold), "25thâ€“75th",
  "High Condition", sprintf("> %.0f", high_threshold), "Above 75th"
)

kable(thresholds, caption = "Body Condition Classification Thresholds")
```

# Key Findings and Next Steps

## What We've Learned in Part 1

1. **Strong Predictive Relationship**: Flipper length explains `r round(model_metrics$r_squared * 100, 1)`% of body mass variance (RÂ² = `r round(model_metrics$r_squared, 3)`), providing a reliable field assessment tool

2. **Species-Specific Patterns**: Residual clustering by species suggests important biological differences not captured by flipper length alone

3. **Model Performance**: RMSE of `r round(model_metrics$rmse, 0)`g indicates reasonable prediction accuracy for most applications

4. **Research Implications**: Simple morphometric relationships can support field research and conservation efforts

## Looking Ahead to Part 2

Our residual analysis reveals clear opportunities for improvement through:

- **Species Integration**: Accounting for biological differences between penguin species
- **Multiple Predictors**: Incorporating bill measurements for enhanced accuracy
- **Interaction Effects**: Exploring how predictors work together
- **Model Validation**: Comparing simple vs. complex model performance

::: {.callout-tip}
## ðŸŽ¯ Preview: Dramatic Model Improvement

In Part 2, adding species information will improve our model's RÂ² from `r round(model_metrics$r_squared, 3)` to over 0.860 - demonstrating why biological context matters in ecological modeling!
:::

# Reproducibility Information

This blog post is part of a **reproducible research compendium** using ZZCOLLAB. To reproduce the entire analysis:

## Quick Start

```bash
git clone <repository-url>
cd posts/palmerpenguinspart1

# Build Docker environment (one-time setup)
make docker-build

# Run complete analysis pipeline and render blog post
make docker-post-render

# View results
open index.html
```

## Analysis Pipeline

The complete analysis consists of three reproducible scripts:

1. **01_prepare_data.R** - Load Palmer Penguins data, clean, and save derived data
2. **02_fit_models.R** - Fit simple linear regression model, extract coefficients and diagnostics
3. **03_generate_figures.R** - Generate publication-quality figures from analysis results

All figures shown in this post are generated by the analysis scripts and can be reproduced exactly using the provided code.

## Environment Information

```{r}
#| label: environment-info
# Create environment information table
env_info <- tibble::tribble(
  ~"Component", ~"Value",
  "R Version", R.version$version.string,
  "Platform", R.version$platform,
  "Analysis Date", as.character(Sys.Date())
)

kable(env_info, col.names = c("", ""), caption = "Analysis Environment")
```

## Data Source

**Palmer Penguins Dataset:**
- Gorman KB, Williams TD, Fraser WR (2014). Ecological sexual dimorphism and environmental variability within a community of Antarctic penguins (genus *Pygoscelis*). PLOS ONE 9(3): e90081.
- Data accessible via: `palmerpenguins` R package
- Original data repository: https://github.com/allisonhorst/palmerpenguins
