---
title: "Setting Up Multi-Language Quarto Documents on macOS"
draft: true
subtitle: "A Complete Guide to R, Python, Julia, and Observable JS Integration"
author: "[Your Name]"
date: "`r Sys.Date()`"
document-type: "blog"
format:
  html:
    toc: true
    toc-depth: 3
    code-fold: true
execute:
  echo: true
  eval: false
---

## Introduction

Creating multi-language documents in Quarto can be powerful but requires careful setup. This guide walks through setting up a macOS environment to run Quarto documents that combine R, Python, Julia, and Observable JS. We'll use the Palmer Penguins dataset as an example, creating visualizations in each language.

## System Requirements

- macOS (tested on Monterey and later)
- At least 8GB RAM
- ~5GB free disk space for all installations
- Admin privileges for installations
- Internet connection for package downloads

## Basic Setup

### 1. R and RStudio

1. Install R from [CRAN](https://cran.r-project.org/)
2. Install [RStudio](https://posit.co/download/rstudio-desktop/)
3. Install [Quarto](https://quarto.org/docs/get-started/)

Install required R packages:

```r
install.packages(c(
  "dplyr",           # for data manipulation
  "ggplot2",         # for R plotting
  "scales",          # for plot formatting
  "reticulate",      # for Python integration
  "JuliaCall"        # for Julia integration
))
```

### 2. Python Setup

1. Install [Anaconda](https://www.anaconda.com/products/distribution) (recommended) or Miniconda
2. Install required Python packages:

```bash
conda install pandas seaborn matplotlib
```

3. Verify Python configuration in R:

```r
library(reticulate)
py_config()  # Should show your Anaconda Python path
```

::: {.callout-important}
## Common Python Issues

- If `py_config()` doesn't show your Anaconda installation, you may need to specify it:
  ```r
  use_python("/path/to/anaconda/bin/python")
  ```
- Seaborn styling requires specific syntax:
  ```python
  sns.set_theme(style="whitegrid")  # Don't use plt.style.use()
  ```
:::

### 3. Julia Setup

1. Install Julia from [julialang.org](https://julialang.org/downloads/)
2. Add Julia to PATH (usually automatic with installer)
3. Install required Julia packages:

```sh
using Pkg
Pkg.add([
  "UnicodePlots",
  "DataFrames",
  "CSV",
  "Statistics"
])
```

4. Setup Julia-R connection:

```r
library(JuliaCall)
julia_setup()
```

::: {.callout-warning}
## Julia Gotchas

- Some Julia plotting backends have system dependencies
- Use UnicodePlots for most reliable results
- Ensure Julia working directory has write permissions
:::

### 4. Observable JS Setup

No separate installation needed, but your Quarto document must include:

```yaml
dependencies:
  - name: "@observablehq/plot"
    version: latest
```

## Verifying Your Setup

Run these commands to verify each language integration:

### R Environment
```r
sessionInfo()
```

### Python Environment
```r
library(reticulate)
py_config()
```

### Julia Environment
```r
library(JuliaCall)
julia_eval("versioninfo()")
```

## Testing a Minimal Example

Here's a minimal example combining all languages:

```{r}
# R code
print("Hello from R!")
```

```{python}
# Python code
print("Hello from Python!")
```

```sh
# Julia code
println("Hello from Julia!")
```

```{ojs}
// Observable JS code
md`Hello from Observable JS!`
```

## Common Issues and Solutions

### Working Directory Problems

All languages need to access the same files. Check working directories:

```r
# R
getwd()

# Python
import os
os.getcwd()

# Julia
pwd()
```

### File Permissions

Ensure your working directory has write permissions:

```bash
chmod 755 /path/to/working/directory
```

### Memory Issues

Monitor memory usage:

```r
# R memory usage
gc()

# Python memory usage
import psutil
psutil.Process().memory_info().rss / 1024 / 1024  # MB
```

## Full Example: Palmer Penguins Visualization

Here's a complete example creating the same visualization in all four languages. See the companion repository at [GitHub Link] for the full code.

## Best Practices

1. **Test Incrementally**
   - Start with R chunks
   - Add Python integration
   - Add Julia integration
   - Finally, add Observable JS

2. **Use Version Control**
   - Track your environment specifications
   - Document package versions
   - Share reproducible setups

3. **Document Dependencies**
   - Create a requirements.txt for Python
   - Use renv for R
   - Document Julia package versions

## Resources

- [Quarto Documentation](https://quarto.org/docs/guide/)
- [R Markdown Cookbook](https://bookdown.org/yihui/rmarkdown-cookbook/)
- [Reticulate Documentation](https://rstudio.github.io/reticulate/)
- [JuliaCall Documentation](https://non-contradiction.github.io/JuliaCall/index.html)
- [Observable Documentation](https://observablehq.com/@observablehq/plot-api-reference)

## Conclusion

Setting up a multi-language Quarto environment requires attention to detail but offers powerful capabilities for data analysis and visualization. Keep your system updated, use version control, and document your setup for reproducibility.

## Session Info

```{r}
sessionInfo()
```

## Appendix: Fully Documented multi3.qmd

Here's a complete, documented version of the multi-language visualization example. Each section includes detailed explanations of the code and important considerations.

```{verbatim}
---
title: "Palmer Penguins: Multi-Language Visualization Comparison"
author: "[Your Name]"
date: "`r Sys.Date()`"
format:
  html:
    # Enable code folding for cleaner output
    code-fold: true
    # Bundle all resources into single HTML
    embed-resources: true
    theme: default
    execute:
      echo: true
# Required for Observable Plot
# Required for Observable Plot
dependencies:
  - name: "@observablehq/plot"
    version: latest
---

## Introduction
This document demonstrates how to create the same visualization - a scatterplot of 
bill depth versus bill length by species - using four different programming 
languages: R, Python, Julia, and Observable JS. Each implementation showcases 
the unique strengths of its ecosystem.

## Data Preparation in R
# First, we load required libraries and prepare our data
```{r setup}
# Load required libraries
library(dplyr)           # For data manipulation
library(ggplot2)         # For visualization
library(scales)          # For plot scaling

# Prepare and save data for other languages
# We remove NA values to ensure consistency across languages
data <- penguins %>% na.omit()

# Save to CSV for other languages to read
# Note: row.names=FALSE prevents adding an index column
write.csv(data, "penguins.csv", row.names = FALSE)

# Display data structure for verification
glimpse(data)
```

## Visualization in R (ggplot2)
# Create a sophisticated scatter plot with trend lines
```{r r_plot}
ggplot(data, aes(x = bill_length_mm, 
                 y = bill_depth_mm, 
                 color = species,
                 shape = species)) +
  # Add points with some transparency
  geom_point(size = 3, alpha = 0.7) +
  # Add trend lines without confidence intervals
  geom_smooth(method = "lm", se = FALSE, linewidth = 0.7, alpha = 0.5) +
  # Use colorblind-friendly palette
  scale_color_brewer(palette = "Set1") +
  # Add clear labels
  labs(title = "Bill Depth vs Length by Species (R)",
       x = "Bill Length (mm)",
       y = "Bill Depth (mm)",
       color = "Species",
       shape = "Species") +
  # Use minimal theme for clean look
  theme_minimal() +
  # Customize theme elements
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    legend.position = "bottom",
    panel.grid.minor = element_blank(),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 12)
  )
```

## Visualization in Python (Seaborn)
# Create equivalent visualization using seaborn
```{python python_plot}
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# Set style - use whitegrid for consistency with R plot
sns.set_theme(style="whitegrid")
sns.set_palette("Set1")  # Match R's color scheme

# Read the CSV file created by R
penguins = pd.read_csv("penguins.csv").dropna()

# Create figure with specific size
plt.figure(figsize=(10, 6))

# Create scatterplot with regression lines
sns.scatterplot(data=penguins, 
                x='bill_length_mm', 
                y='bill_depth_mm', 
                hue='species',
                style='species',
                s=100,  # Point size
                alpha=0.7)  # Match R's transparency

# Add overall trend line
sns.regplot(data=penguins, 
            x='bill_length_mm', 
            y='bill_depth_mm',
            scatter=False,
            color='gray',
            line_kws={'alpha': 0.5})

# Customize plot
plt.title('Bill Depth vs Length by Species (Python)', 
          pad=20, 
          size=14, 
          weight='bold')
plt.xlabel('Bill Length (mm)', size=12)
plt.ylabel('Bill Depth (mm)', size=12)

# Adjust legend position to match R plot
plt.legend(title='Species', bbox_to_anchor=(0.5, -0.15), 
          loc='upper center', ncol=3)

# Adjust layout to prevent cutoff
plt.tight_layout()
plt.show()
```

## Visualization in Julia
# Create a text-based scatter plot using UnicodePlots
```sh
using UnicodePlots  # For reliable plotting in any environment
using DataFrames    # For data manipulation
using CSV          # For reading CSV
using Statistics   # For basic stats

# Read data
penguins = CSV.read("penguins.csv", DataFrame)
dropmissing!(penguins)  # Remove any NA values

# Create scatter plot
# Note: Using UnicodePlots for reliability across environments
plt = scatterplot(
    penguins.bill_length_mm,
    penguins.bill_depth_mm,
    name = string.(penguins.species),  # Convert species to strings
    title = "Bill Depth vs Length by Species (Julia)",
    xlabel = "Bill Length (mm)",
    ylabel = "Bill Depth (mm)",
    canvas = DotCanvas  # Use dots for points
)

# Show plot
plt
```

## Visualization in Observable JS
# Create an interactive visualization using Observable Plot
```{ojs}
// Import Observable Plot library
import { Plot } from "@observablehq/plot"

// Load and prepare data
penguins = FileAttachment("penguins.csv").csv()

// Create plot with Observable Plot
Plot.plot({
  // Use consistent color scheme
  color: {scheme: "category10"},
  // Add scatter plot points
  marks: [
    Plot.dot(penguins, {
      x: "bill_length_mm",
      y: "bill_depth_mm",
      stroke: "species",
      fill: "species"
    })
  ],
  // Add axis labels
  x: {label: "Bill Length (mm)"},
  y: {label: "Bill Depth (mm)"},
  // Add title
  title: "Bill Depth vs Length by Species (Observable JS)"
})
```

## Conclusion
Each language offers unique advantages for visualization:

- **R (ggplot2)**: Excellent defaults and highly customizable aesthetic options
- **Python (Seaborn)**: Clean integration with statistical functions and good 
  handling of categorical variables
- **Julia (UnicodePlots)**: Fast performance and text-based visualization 
  capabilities
- **Observable JS**: Interactive capabilities and web-native visualization

The core visualization remains consistent across all implementations, showing the 
relationship between bill depth and length across different penguin species, while 
each implementation showcases the strengths of its respective ecosystem.
```

### Key Implementation Notes

1. **YAML Header**
   - Includes necessary dependencies for Observable Plot
   - Sets up HTML output with code folding
   - Ensures resources are embedded for portability

2. **Data Preparation**
   - Uses R for initial data loading and cleaning
   - Exports clean CSV for other languages
   - Maintains consistent data across all visualizations

3. **Language-Specific Considerations**
   - R: Uses ggplot2 for publication-quality static plots
   - Python: Matches R's aesthetic choices for consistency
   - Julia: Uses UnicodePlots for reliability
   - Observable JS: Provides interactive web-native visualization

4. **Common Patterns**
   - Consistent color schemes
   - Similar axis labels and titles
   - Comparable point sizes and transparencies
   - Aligned legend positions where possible

5. **Error Prevention**
   - Explicit NA handling
   - Consistent working directory usage
   - Clear data export/import chain
   - Reliable plotting backends

This implementation provides a robust template for multi-language visualization
that can be adapted for other datasets and analysis needs.

## Prerequisites

In development

## Step-by-Step Implementation

In development

## Key Takeaways

In development

## Further Reading

In development
